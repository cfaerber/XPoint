#!/bin/bash
echo "Starting $0"
oxpdir=/home/boettger/openxp/
scriptdir="$oxpdir"script/
diffdir="$oxpdir"diff/
dailydifffile=$diffdir'openxpdiff_3.9_'`date +%d.%m.%y`
dailydifffile38=$diffdir'openxpdiff_3.8_'`date +%d.%m.%y`
#mailtoaddr=openxp-cvs@lists.sourceforge.net

echo Generating diffs in $diffdir
echo $dailydifffile
echo $dailydifffile38
sleep 1

# 3.9.x
echo Generating $dailydifffile for 3.9.x
cd "$oxpdir"3.9/openxp
pwd
sleep 1
#cvs up -A
cvs up -A -d
cvs diff -u -D "-1 day" | grep -v -w "\?" > $dailydifffile
#test -s $dailydifffile && mailx -s dailydiff $mailtoaddr < $dailydifffile

# 3.8.x
echo Generating $dailydifffile for 3.8.x
cd "$oxpdir"3.8/openxp
pwd
sleep 1
#cvs up -r branch_3_7_8
cvs up -r branch_3_7_8 -d
cvs diff -u  -D "-1 day" | grep -v -w "\?" > $dailydifffile38

echo Starting snapshot builds if needed
test -s $dailydifffile38 && "$scriptdir"snapshot 3.8
test -s $dailydifffile && "$scriptdir"snapshot 3.9
echo "Finished $0"
